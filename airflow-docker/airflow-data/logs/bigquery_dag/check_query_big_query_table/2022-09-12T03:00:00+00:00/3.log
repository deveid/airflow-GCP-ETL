[2022-09-18 18:31:44,360] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [queued]>
[2022-09-18 18:31:44,478] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [queued]>
[2022-09-18 18:31:44,480] {taskinstance.py:1017} INFO - 
--------------------------------------------------------------------------------
[2022-09-18 18:31:44,481] {taskinstance.py:1018} INFO - Starting attempt 3 of 3
[2022-09-18 18:31:44,482] {taskinstance.py:1019} INFO - 
--------------------------------------------------------------------------------
[2022-09-18 18:31:44,590] {taskinstance.py:1038} INFO - Executing <Task(BigQueryCheckOperator): check_query_big_query_table> on 2022-09-12T03:00:00+00:00
[2022-09-18 18:31:44,627] {standard_task_runner.py:51} INFO - Started process 1562 to run task
[2022-09-18 18:31:44,682] {standard_task_runner.py:75} INFO - Running: ['airflow', 'tasks', 'run', 'bigquery_dag', 'check_query_big_query_table', '2022-09-12T03:00:00+00:00', '--job-id', '276', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/dag_with_bigquery.py', '--cfg-path', '/tmp/tmp2ya3_0x4']
[2022-09-18 18:31:44,721] {standard_task_runner.py:76} INFO - Job 276: Subtask check_query_big_query_table
[2022-09-18 18:31:45,054] {logging_mixin.py:103} INFO - Running <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [running]> on host 27377494ab8b
[2022-09-18 18:31:45,682] {taskinstance.py:1232} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Dave
AIRFLOW_CTX_DAG_ID=bigquery_dag
AIRFLOW_CTX_TASK_ID=check_query_big_query_table
AIRFLOW_CTX_EXECUTION_DATE=2022-09-12T03:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-09-12T03:00:00+00:00
[2022-09-18 18:31:45,727] {sql.py:87} INFO - Executing SQL check: 
           select id from githubarchive.day.20220914
        
[2022-09-18 18:31:45,834] {logging_mixin.py:103} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:120 DeprecationWarning: This method will be deprecated. Please use `BigQueryHook.get_client` method
[2022-09-18 18:31:48,273] {logging_mixin.py:103} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:2052 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2022-09-18 18:31:48,323] {bigquery.py:1510} INFO - Inserting job airflow_1663525908307891_06d2bf8b43be9b79a3e89edf3b53e367
[2022-09-18 18:31:50,628] {local_task_job.py:170} WARNING - State of this instance has been externally set to None. Terminating instance.
[2022-09-18 18:31:50,944] {process_utils.py:95} INFO - Sending Signals.SIGTERM to GPID 1562
[2022-09-18 18:31:50,981] {taskinstance.py:1214} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-09-18 18:31:51,159] {taskinstance.py:1396} ERROR - Task received SIGTERM signal
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1086, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1260, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1300, in _execute_task
    result = task_copy.execute(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/sql.py", line 88, in execute
    records = self.get_db_hook().get_first(self.sql)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/hooks/dbapi.py", line 153, in get_first
    return cur.fetchone()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py", line 2664, in fetchone
    return self.next()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py", line 2680, in next
    self.service.jobs()
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/discovery.py", line 1410, in methodResource
    schema=schema,
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/discovery.py", line 1289, in __init__
    self._set_service_methods()
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/discovery.py", line 1338, in _set_service_methods
    self._add_basic_methods(self._resourceDesc, self._rootDesc, self._schema)
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/discovery.py", line 1372, in _add_basic_methods
    methodName, methodDesc, rootDesc, schema
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/discovery.py", line 1183, in createMethod
    docs.append(schema.prettyPrintSchema(methodDesc["response"]))
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/schema.py", line 158, in prettyPrintSchema
    return self._prettyPrintSchema(schema, dent=1)[:-2]
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/_helpers.py", line 134, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/schema.py", line 145, in _prettyPrintSchema
    return _SchemaToStruct(schema, seen, dent=dent).to_str(self._prettyPrintByName)
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/schema.py", line 315, in to_str
    return self._to_str_impl(self.schema)
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/schema.py", line 271, in _to_str_impl
    self.emit(line.rstrip())
  File "/home/airflow/.local/lib/python3.6/site-packages/googleapiclient/schema.py", line 208, in emit
    self.value.extend(["  " * self.dent, text, "\n"])
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1216, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2022-09-18 18:31:51,249] {taskinstance.py:1440} INFO - Marking task as FAILED. dag_id=bigquery_dag, task_id=check_query_big_query_table, execution_date=20220912T030000, start_date=20220918T183144, end_date=20220918T183151
[2022-09-18 18:31:51,648] {process_utils.py:61} INFO - Process psutil.Process(pid=1562, status='terminated', exitcode=1, started='18:31:44') (1562) terminated with exit code 1
[2022-09-18 18:31:51,661] {local_task_job.py:118} INFO - Task exited with return code 1
[2022-09-18 19:18:34,629] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [queued]>
[2022-09-18 19:18:34,700] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [queued]>
[2022-09-18 19:18:34,704] {taskinstance.py:1017} INFO - 
--------------------------------------------------------------------------------
[2022-09-18 19:18:34,705] {taskinstance.py:1018} INFO - Starting attempt 3 of 3
[2022-09-18 19:18:34,706] {taskinstance.py:1019} INFO - 
--------------------------------------------------------------------------------
[2022-09-18 19:18:34,757] {taskinstance.py:1038} INFO - Executing <Task(BigQueryCheckOperator): check_query_big_query_table> on 2022-09-12T03:00:00+00:00
[2022-09-18 19:18:34,770] {standard_task_runner.py:51} INFO - Started process 3999 to run task
[2022-09-18 19:18:34,800] {standard_task_runner.py:75} INFO - Running: ['airflow', 'tasks', 'run', 'bigquery_dag', 'check_query_big_query_table', '2022-09-12T03:00:00+00:00', '--job-id', '369', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/dag_with_bigquery.py', '--cfg-path', '/tmp/tmpu71t4jpn']
[2022-09-18 19:18:34,832] {standard_task_runner.py:76} INFO - Job 369: Subtask check_query_big_query_table
[2022-09-18 19:18:35,068] {logging_mixin.py:103} INFO - Running <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [running]> on host 27377494ab8b
[2022-09-18 19:18:35,275] {taskinstance.py:1232} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Dave
AIRFLOW_CTX_DAG_ID=bigquery_dag
AIRFLOW_CTX_TASK_ID=check_query_big_query_table
AIRFLOW_CTX_EXECUTION_DATE=2022-09-12T03:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-09-12T03:00:00+00:00
[2022-09-18 19:18:35,294] {sql.py:87} INFO - Executing SQL check: 
           select id from githubarchive.day.20220914
        
[2022-09-18 19:18:35,356] {logging_mixin.py:103} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:120 DeprecationWarning: This method will be deprecated. Please use `BigQueryHook.get_client` method
[2022-09-18 19:18:36,163] {logging_mixin.py:103} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:2052 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2022-09-18 19:18:36,170] {bigquery.py:1510} INFO - Inserting job airflow_1663528716167558_06d2bf8b43be9b79a3e89edf3b53e367
[2022-09-18 19:18:36,653] {taskinstance.py:1396} ERROR - 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/quick-keel-213611/jobs?prettyPrint=false: Access Denied: Project quick-keel-213611: User does not have bigquery.jobs.create permission in project quick-keel-213611.

(job ID: airflow_1663528716167558_06d2bf8b43be9b79a3e89edf3b53e367)

             -----Query Job SQL Follows-----             

    |    .    |    .    |    .    |    .    |    .    |
   1:
   2:           select id from githubarchive.day.20220914
   3:        
    |    .    |    .    |    .    |    .    |    .    |

(job ID: airflow_1663528716167558_06d2bf8b43be9b79a3e89edf3b53e367)

             -----Query Job SQL Follows-----             

    |    .    |    .    |    .    |    .    |    .    |
   1:
   2:           select id from githubarchive.day.20220914
   3:        
    |    .    |    .    |    .    |    .    |    .    |
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1086, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1260, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1300, in _execute_task
    result = task_copy.execute(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/sql.py", line 88, in execute
    records = self.get_db_hook().get_first(self.sql)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/hooks/dbapi.py", line 152, in get_first
    cur.execute(sql)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py", line 2639, in execute
    self.job_id = self.hook.run_query(sql)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py", line 2186, in run_query
    job = self.insert_job(configuration=configuration, project_id=self.project_id)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/common/hooks/base_google.py", line 425, in inner_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py", line 1512, in insert_job
    job.result()
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1159, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 628, in result
    self._begin(retry=retry, timeout=timeout)
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1069, in _begin
    super(QueryJob, self)._begin(client=client, retry=retry, timeout=timeout)
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 438, in _begin
    timeout=timeout,
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 640, in _call_api
    return call()
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 483, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.Forbidden: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/quick-keel-213611/jobs?prettyPrint=false: Access Denied: Project quick-keel-213611: User does not have bigquery.jobs.create permission in project quick-keel-213611.

(job ID: airflow_1663528716167558_06d2bf8b43be9b79a3e89edf3b53e367)

             -----Query Job SQL Follows-----             

    |    .    |    .    |    .    |    .    |    .    |
   1:
   2:           select id from githubarchive.day.20220914
   3:        
    |    .    |    .    |    .    |    .    |    .    |

(job ID: airflow_1663528716167558_06d2bf8b43be9b79a3e89edf3b53e367)

             -----Query Job SQL Follows-----             

    |    .    |    .    |    .    |    .    |    .    |
   1:
   2:           select id from githubarchive.day.20220914
   3:        
    |    .    |    .    |    .    |    .    |    .    |
[2022-09-18 19:18:36,691] {taskinstance.py:1440} INFO - Marking task as FAILED. dag_id=bigquery_dag, task_id=check_query_big_query_table, execution_date=20220912T030000, start_date=20220918T191834, end_date=20220918T191836
[2022-09-18 19:18:36,829] {local_task_job.py:118} INFO - Task exited with return code 1
[2022-09-18 20:16:22,218] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [queued]>
[2022-09-18 20:16:22,548] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [queued]>
[2022-09-18 20:16:22,554] {taskinstance.py:1017} INFO - 
--------------------------------------------------------------------------------
[2022-09-18 20:16:22,558] {taskinstance.py:1018} INFO - Starting attempt 3 of 3
[2022-09-18 20:16:22,563] {taskinstance.py:1019} INFO - 
--------------------------------------------------------------------------------
[2022-09-18 20:16:22,743] {taskinstance.py:1038} INFO - Executing <Task(BigQueryCheckOperator): check_query_big_query_table> on 2022-09-12T03:00:00+00:00
[2022-09-18 20:16:22,787] {standard_task_runner.py:51} INFO - Started process 1522 to run task
[2022-09-18 20:16:22,899] {standard_task_runner.py:75} INFO - Running: ['airflow', 'tasks', 'run', 'bigquery_dag', 'check_query_big_query_table', '2022-09-12T03:00:00+00:00', '--job-id', '474', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/dag_with_bigquery.py', '--cfg-path', '/tmp/tmp5j7irmgl']
[2022-09-18 20:16:22,931] {standard_task_runner.py:76} INFO - Job 474: Subtask check_query_big_query_table
[2022-09-18 20:16:23,189] {logging_mixin.py:103} INFO - Running <TaskInstance: bigquery_dag.check_query_big_query_table 2022-09-12T03:00:00+00:00 [running]> on host 27377494ab8b
[2022-09-18 20:16:23,512] {taskinstance.py:1232} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Dave
AIRFLOW_CTX_DAG_ID=bigquery_dag
AIRFLOW_CTX_TASK_ID=check_query_big_query_table
AIRFLOW_CTX_EXECUTION_DATE=2022-09-12T03:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-09-12T03:00:00+00:00
[2022-09-18 20:16:23,530] {sql.py:87} INFO - Executing SQL check: 
           select id from githubarchive.day.20220914
        
[2022-09-18 20:16:23,697] {logging_mixin.py:103} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:120 DeprecationWarning: This method will be deprecated. Please use `BigQueryHook.get_client` method
[2022-09-18 20:16:25,218] {logging_mixin.py:103} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:2052 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2022-09-18 20:16:25,250] {bigquery.py:1510} INFO - Inserting job airflow_1663532185235323_06d2bf8b43be9b79a3e89edf3b53e367
[2022-09-18 20:17:15,432] {sql.py:90} INFO - Record: ['23990728531']
[2022-09-18 20:17:15,525] {sql.py:96} INFO - Success.
[2022-09-18 20:17:16,025] {taskinstance.py:1142} INFO - Marking task as SUCCESS. dag_id=bigquery_dag, task_id=check_query_big_query_table, execution_date=20220912T030000, start_date=20220918T201622, end_date=20220918T201716
[2022-09-18 20:17:17,712] {local_task_job.py:170} WARNING - State of this instance has been externally set to success. Terminating instance.
[2022-09-18 20:17:18,480] {process_utils.py:95} INFO - Sending Signals.SIGTERM to GPID 1522
[2022-09-18 20:17:18,512] {taskinstance.py:1214} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-09-18 20:17:20,986] {process_utils.py:61} INFO - Process psutil.Process(pid=1522, status='terminated', exitcode=1, started='20:16:22') (1522) terminated with exit code 1
[2022-09-18 20:17:21,024] {local_task_job.py:118} INFO - Task exited with return code 1
